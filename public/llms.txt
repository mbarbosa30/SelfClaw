# SelfClaw - Agent Verification Registry

> Verified agent keys, backed by Self.

SelfClaw provides sybil-resistant verification for AI agents using Self.xyz passport proofs on Celo blockchain. Most "AI agents" are just REST APIs — anyone with an API key can post as an agent. SelfClaw solves this with cryptographic proof of humanity.

**Website:** https://selfclaw.app

## Quick Integration

### Check if an agent is verified

```javascript
// publicKey should be SPKI DER format (base64), starts with "MCowBQ..."
const response = await fetch(
  `https://selfclaw.app/api/selfclaw/v1/agent/${encodeURIComponent(publicKey)}`
);
const data = await response.json();

if (data.verified) {
  console.log("Agent is backed by a verified human!");
  console.log("Human ID:", data.humanId);
  console.log("Swarm:", data.swarm); // All agents from this human
}
```

## API Endpoints

| Endpoint | Description |
|----------|-------------|
| `GET /api/selfclaw/v1/agent/{identifier}` | Check agent verification (publicKey or agentName) |
| `GET /api/selfclaw/v1/human/{humanId}` | Get all agents for a human (swarm) |
| `GET /api/selfclaw/v1/stats` | Registry statistics |
| `POST /api/selfclaw/v1/start-verification` | Start verification flow (returns sessionId + QR config) |
| `POST /api/selfclaw/v1/sign-challenge` | Optional: Submit Ed25519 signature for enhanced verification |
| `POST /api/selfclaw/v1/callback` | Self.xyz proof callback (called by Self app) |

**Note:** When passing publicKey in URLs, use `encodeURIComponent()` since base64 contains `+`, `/`, `=` which are not URL-safe.

## Response Format

```json
{
  "verified": true,
  "publicKey": "MCowBQYDK2VwAyEA...",
  "agentName": "my-research-agent",
  "humanId": "0x1234abcd...",
  "selfxyz": {
    "verified": true,
    "registeredAt": "2026-02-01T12:00:00Z"
  },
  "swarm": "https://selfclaw.app/human/0x1234abcd..."
}
```

## Why SelfClaw?

1. **Passport-First** - Self.xyz uses your passport's NFC chip for verification. Works anywhere with a phone.
2. **Zero-Knowledge Proofs** - Raw passport data stays on your device; only the proof is shared. Privacy by mathematics.
3. **129+ Countries** - Supports biometric passports with NFC chips. Global coverage out of the box.
4. **One Human, Many Agents** - Register your entire agent swarm under one verified identity.
5. **Built on Celo** - Fast, cheap, mobile-first blockchain. On-chain attestations.

## Implementation Steps

1. Generate Ed25519 keypair for your agent (SPKI DER format)
2. Visit https://selfclaw.app to verify
3. Enter your agent's public key (starts with `MCowBQ...`)
4. Scan QR code with Self.xyz mobile app — done
5. Query API to confirm verification

> Note: If you're new to Self.xyz, you'll set up the app once by tapping your passport's NFC chip. After that, verifications are just a QR scan.

## Signature Verification Flow

When verifying an agent's identity in your application:

1. Generate unique challenge with domain, timestamp, nonce, and agentKeyHash
2. Request agent signs challenge with Ed25519 private key
3. Verify signature matches claimed public key
4. Query SelfClaw API to confirm public key is registered

```javascript
import { createHash } from "crypto";

// 1. Generate challenge (include agentKeyHash to bind proof to this specific agent)
const agentKeyHash = createHash("sha256").update(publicKey).digest("hex");
const challenge = JSON.stringify({
  domain: "your-app.com",
  timestamp: Date.now(),
  nonce: crypto.randomUUID(),
  agentKeyHash: agentKeyHash
});

// 2. Agent signs and returns { publicKey, signature }
// 3. Verify signature using Node crypto or @noble/ed25519
import { verify } from "@noble/ed25519";
const isValid = await verify(signature, challenge, publicKeyRaw); // raw 32-byte key for noble

// 4. Check SelfClaw registry
if (isValid) {
  const res = await fetch(
    `https://selfclaw.app/api/selfclaw/v1/agent/${encodeURIComponent(publicKey)}`
  );
  const data = await res.json();
  if (data.verified) {
    console.log("Agent is verified by human:", data.humanId);
  }
}
```

## Security Considerations

- **Challenge binding**: Include `agentKeyHash` in challenges to bind verification to a specific agent key
- **Unique challenges**: Always include domain, timestamp, and nonce to prevent replay attacks
- **Verify signature first**: Check signature validity before querying registry
- **Privacy model**: Raw passport data never leaves the user's device — only ZK proofs are shared
- **Swarm tracking**: Use `humanId` to identify all agents from the same human

## Key Format

SelfClaw uses **SPKI DER format** (base64 encoded) for Ed25519 public keys:
- Example: `MCowBQYDK2VwAyEA...`
- Generate with Node.js: `publicKey.export({ type: "spki", format: "der" }).toString("base64")`

## Built With

- **Self.xyz** - Privacy-preserving passport verification with ZK proofs
- **Celo** - Mobile-first blockchain for on-chain verification records

## Links

- Landing Page: https://selfclaw.app
- Developer Docs: https://selfclaw.app/developers
- Self.xyz Docs: https://docs.self.xyz
