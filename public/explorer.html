<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MCP Explorer | SelfClaw</title>
  <meta name="description" content="Explore Hostinger MCP integration for SelfClaw agent infrastructure.">
  <link rel="canonical" href="https://selfclaw.ai/explorer">

  <meta property="og:type" content="website">
  <meta property="og:url" content="https://selfclaw.ai/explorer">
  <meta property="og:title" content="MCP Explorer | SelfClaw">
  <meta property="og:description" content="Explore Hostinger MCP integration for SelfClaw agent infrastructure.">
  <meta property="og:image" content="https://selfclaw.ai/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="675">
  <meta property="og:site_name" content="SelfClaw">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@mbarrbosa">
  <meta name="twitter:title" content="MCP Explorer | SelfClaw">
  <meta name="twitter:description" content="Explore Hostinger MCP integration for SelfClaw agent infrastructure.">
  <meta name="twitter:image" content="https://selfclaw.ai/og-image.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
    .explorer-page { max-width: 960px; margin: 0 auto; padding: 0 var(--space-md); }

    .status-bar {
      display: flex; align-items: center; gap: 0.75rem;
      padding: 1rem; border: 2px solid var(--border-heavy);
      margin-bottom: var(--space-md); font-family: var(--font-mono); font-size: 0.8rem;
    }
    .status-dot {
      width: 10px; height: 10px; flex-shrink: 0;
    }
    .status-dot.connected { background: var(--green-verify); }
    .status-dot.disconnected { background: var(--red); }
    .status-dot.loading { background: var(--yellow); animation: pulse 1s infinite; }
    @keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.3; } }

    .tool-groups { display: flex; flex-direction: column; gap: var(--space-md); }

    .tool-group-header {
      font-family: var(--font-mono); font-size: 0.75rem; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.12em; color: var(--accent);
      padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-light);
      display: flex; align-items: center; gap: 0.4rem;
    }
    .tool-group-header::before {
      content: ''; display: inline-block; width: 6px; height: 6px;
      background: var(--green-verify); flex-shrink: 0;
    }

    .tool-list { display: flex; flex-direction: column; gap: 0.5rem; }

    .tool-item {
      border: 2px solid var(--border-heavy); padding: 1rem;
      cursor: pointer; transition: border-color 0.2s;
    }
    .tool-item:hover { border-color: var(--green-verify); }
    .tool-item.active { border-color: var(--green-verify); border-top: 3px solid var(--green-verify); }

    .tool-name {
      font-family: var(--font-mono); font-size: 0.8rem; font-weight: 600;
      color: var(--text-primary);
    }
    .tool-desc {
      font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.25rem;
      line-height: 1.4;
    }

    .tool-panel {
      border: 2px solid var(--border-heavy); padding: var(--space-md);
      margin-top: var(--space-sm); display: none;
    }
    .tool-panel.open { display: block; }

    .tool-panel-title {
      font-family: var(--font-mono); font-size: 0.7rem; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary);
      margin-bottom: var(--space-sm);
    }

    .param-row {
      display: flex; gap: 0.75rem; align-items: center;
      margin-bottom: 0.5rem; flex-wrap: wrap;
    }
    .param-label {
      font-family: var(--font-mono); font-size: 0.75rem; font-weight: 500;
      min-width: 160px; color: var(--text-primary);
    }
    .param-type {
      font-family: var(--font-mono); font-size: 0.65rem;
      color: var(--text-secondary); margin-left: 0.25rem;
    }
    .param-input {
      flex: 1; min-width: 200px; padding: 0.5rem 0.75rem;
      border: 2px solid var(--border-light); background: var(--bg-card);
      font-family: var(--font-mono); font-size: 0.8rem; color: var(--text-primary);
    }
    .param-input:focus { outline: none; border-color: var(--green-verify); }

    .run-btn {
      margin-top: var(--space-sm); padding: 0.6rem 1.5rem;
      background: var(--accent); color: #fff; border: none;
      font-family: var(--font-mono); font-size: 0.8rem; font-weight: 600;
      text-transform: uppercase; letter-spacing: 0.08em; cursor: pointer;
    }
    .run-btn:hover { background: var(--accent-hover); }
    .run-btn:disabled { opacity: 0.5; cursor: not-allowed; }

    .result-box {
      margin-top: var(--space-sm); padding: 1rem;
      border: 2px solid var(--border-light); background: var(--bg-card);
      font-family: var(--font-mono); font-size: 0.75rem;
      white-space: pre-wrap; word-break: break-all;
      max-height: 400px; overflow-y: auto; line-height: 1.5;
      display: none;
    }
    .result-box.visible { display: block; }
    .result-box.error { border-color: var(--red); color: var(--red); }

    .search-input {
      width: 100%; padding: 0.75rem 1rem;
      border: 2px solid var(--border-heavy); background: var(--bg-card);
      font-family: var(--font-mono); font-size: 0.85rem;
      color: var(--text-primary); margin-bottom: var(--space-md);
    }
    .search-input:focus { outline: none; border-color: var(--green-verify); }
    .search-input::placeholder { color: var(--text-muted); }

    .tool-count {
      font-family: var(--font-mono); font-size: 0.75rem;
      color: var(--text-secondary); margin-bottom: var(--space-sm);
    }

    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="site-container">
    <header class="site-header">
      <a href="/" class="site-logo"><img src="/claw-icon.svg" alt="" class="site-logo-icon">SELFCLAW</a>
      <button class="nav-toggle" aria-label="Menu">&equiv;</button>
      <nav class="site-nav">
        <a href="/verify" class="nav-link">VERIFY</a>
        <a href="/registry" class="nav-link" data-gate style="display:none">AGENTS</a>
        <a href="/dashboard" class="nav-link" data-gate style="display:none">DASHBOARD</a>
        <a href="/economy" class="nav-link">ECONOMY</a>
        <a href="/developers" class="nav-link">DOCS</a>
        <a href="/guide" class="nav-link">GUIDE</a>
        <a href="/whitepaper" class="nav-link">WHITEPAPER</a>
        <a href="/manifesto" class="nav-link">\\\</a>
      </nav>
    </header>
  </div>

  <div class="explorer-page">
    <section class="hero" style="padding: 3rem 0 var(--space-lg);">
      <div class="hero-label">Infrastructure Control</div>
      <h1>Hostinger MCP Explorer</h1>
      <p class="hero-sub">Browse and execute 100+ Hostinger API tools via the Model Context Protocol. Manage hosting, domains, VPS, DNS, and more.</p>
    </section>

    <div id="status-bar" class="status-bar">
      <div id="status-dot" class="status-dot loading"></div>
      <span id="status-text">Connecting to Hostinger MCP...</span>
    </div>

    <input type="text" class="search-input" id="tool-search" placeholder="Search tools... (e.g. dns, vps, domain, hosting)" disabled>
    <div class="tool-count" id="tool-count"></div>

    <div class="tool-groups" id="tool-groups">
    </div>
  </div>

  <footer class="site-footer">
    <div class="site-container">
      <div class="footer-inner">
        <span class="footer-brand">SelfClaw</span>
        <span class="footer-sep">&mdash;</span>
        <span class="footer-tagline">Verification infrastructure for agent economies</span>
        <span class="footer-links"><a href="https://github.com/mbarbosa30/SelfClaw" target="_blank" rel="noopener">GitHub</a> &middot; <a href="https://t.me/+GC2quXBnarw1MzU0" target="_blank" rel="noopener">Telegram</a> &middot; <a href="https://x.com/selfclaw" target="_blank" rel="noopener">X</a></span>
      </div>
    </div>
  </footer>

  <script src="/auth.js"></script>
  <script src="nav-gate.js"></script>
  <script>
    const statusDot = document.getElementById('status-dot');
    const statusText = document.getElementById('status-text');
    const toolGroups = document.getElementById('tool-groups');
    const toolSearch = document.getElementById('tool-search');
    const toolCount = document.getElementById('tool-count');
    let allTools = [];
    let toolDataMap = {};

    function escAttr(s) {
      return String(s).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    }

    function escHtml(s) {
      const d = document.createElement('div');
      d.textContent = s;
      return d.innerHTML;
    }

    (function gateExplorer() {
      var explorerContent = document.querySelector('.explorer-page');
      if (!explorerContent) return;
      window.selfclawAuth.onReady(function(user) {
        if (!user) {
          explorerContent.innerHTML = '<div style="text-align:center;padding:4rem 1rem;border:2px solid var(--border-heavy);">' +
            '<div style="font-family:var(--font-mono);font-size:0.85rem;font-weight:600;text-transform:uppercase;letter-spacing:0.1em;margin-bottom:1rem;">Authentication Required</div>' +
            '<p style="font-size:0.9rem;color:var(--text-secondary);margin-bottom:1.5rem;max-width:400px;margin-left:auto;margin-right:auto;">You must be logged in with your Self.xyz passport to access the MCP Explorer.</p>' +
            '<button onclick="window.selfclawAuth && window.selfclawAuth.openLogin()" style="padding:0.7rem 2rem;border:2px solid var(--border-heavy);background:var(--bg-card);color:var(--text-primary);font-family:var(--font-mono);font-size:0.8rem;font-weight:600;cursor:pointer;">Login with Self</button>' +
            '</div>';
        } else {
          connect();
        }
      });
    })();

    async function connect() {
      try {
        const res = await fetch('/api/hostinger/status');
        const data = await res.json();
        if (data.connected) {
          statusDot.className = 'status-dot connected';
          statusText.textContent = 'Connected to Hostinger MCP';
          loadTools();
        } else {
          statusDot.className = 'status-dot disconnected';
          statusText.textContent = 'Disconnected: ' + (data.error || 'Unknown error');
        }
      } catch (err) {
        statusDot.className = 'status-dot disconnected';
        statusText.textContent = 'Failed to reach API';
      }
    }

    async function loadTools() {
      try {
        const res = await fetch('/api/hostinger/tools');
        const data = await res.json();
        if (data.error) {
          toolGroups.textContent = '';
          var errP = document.createElement('p');
          errP.style.color = 'var(--red)';
          errP.textContent = 'Error: ' + data.error;
          toolGroups.appendChild(errP);
          return;
        }
        allTools = [];
        toolDataMap = {};
        const groups = data.groups;
        const sortedGroups = Object.keys(groups).sort();

        toolCount.textContent = data.total + ' tools available';
        toolSearch.disabled = false;

        toolGroups.textContent = '';

        for (const group of sortedGroups) {
          const tools = groups[group];
          for (const t of tools) {
            allTools.push({ ...t, group });
            toolDataMap[t.name] = t;
          }

          var groupDiv = document.createElement('div');
          groupDiv.className = 'tool-group';
          groupDiv.setAttribute('data-group', escAttr(group));

          var headerDiv = document.createElement('div');
          headerDiv.className = 'tool-group-header';
          headerDiv.textContent = group + ' (' + tools.length + ')';
          groupDiv.appendChild(headerDiv);

          var listDiv = document.createElement('div');
          listDiv.className = 'tool-list';

          for (const tool of tools) {
            var safeName = escAttr(tool.name);
            var params = extractParams(tool.inputSchema);

            var itemDiv = document.createElement('div');
            itemDiv.className = 'tool-item';
            itemDiv.setAttribute('data-name', tool.name);
            itemDiv.addEventListener('click', (function(el) { return function() { toggleTool(el); }; })(itemDiv));

            var nameDiv = document.createElement('div');
            nameDiv.className = 'tool-name';
            nameDiv.textContent = tool.name;
            if (!tool.allowed) {
              var lockSpan = document.createElement('span');
              lockSpan.style.cssText = 'margin-left:0.5rem;font-size:0.65rem;color:var(--text-secondary);';
              lockSpan.textContent = '(restricted)';
              nameDiv.appendChild(lockSpan);
            }
            itemDiv.appendChild(nameDiv);

            if (tool.description) {
              var descDiv = document.createElement('div');
              descDiv.className = 'tool-desc';
              descDiv.textContent = tool.description;
              itemDiv.appendChild(descDiv);
            }

            var panelDiv = document.createElement('div');
            panelDiv.className = 'tool-panel';
            panelDiv.id = 'panel-' + safeName;

            var titleDiv = document.createElement('div');
            titleDiv.className = 'tool-panel-title';
            titleDiv.textContent = 'Parameters';
            panelDiv.appendChild(titleDiv);

            if (params.length === 0) {
              var noParams = document.createElement('div');
              noParams.style.cssText = 'font-size:0.8rem;color:var(--text-secondary)';
              noParams.textContent = 'No parameters required';
              panelDiv.appendChild(noParams);
            } else {
              for (var pi = 0; pi < params.length; pi++) {
                var p = params[pi];
                var row = document.createElement('div');
                row.className = 'param-row';
                var label = document.createElement('label');
                label.className = 'param-label';
                label.textContent = p.name;
                var typeSpan = document.createElement('span');
                typeSpan.className = 'param-type';
                typeSpan.textContent = ' ' + p.type + (p.required ? ' *' : '');
                label.appendChild(typeSpan);
                var input = document.createElement('input');
                input.className = 'param-input';
                input.setAttribute('data-param', p.name);
                input.placeholder = p.description || '';
                row.appendChild(label);
                row.appendChild(input);
                panelDiv.appendChild(row);
              }
            }

            var runBtn = document.createElement('button');
            runBtn.className = 'run-btn';
            runBtn.textContent = 'Execute';
            (function(tn, rb) {
              rb.addEventListener('click', function(e) {
                e.stopPropagation();
                runTool(tn, rb);
              });
            })(tool.name, runBtn);
            panelDiv.appendChild(runBtn);

            var resultBox = document.createElement('div');
            resultBox.className = 'result-box';
            resultBox.id = 'result-' + safeName;
            panelDiv.appendChild(resultBox);

            itemDiv.appendChild(panelDiv);
            listDiv.appendChild(itemDiv);
          }

          groupDiv.appendChild(listDiv);
          toolGroups.appendChild(groupDiv);
        }
      } catch (err) {
        toolGroups.textContent = '';
        var errP = document.createElement('p');
        errP.style.color = 'var(--red)';
        errP.textContent = 'Failed to load tools';
        toolGroups.appendChild(errP);
      }
    }

    function extractParams(schema) {
      if (!schema || !schema.properties) return [];
      const required = schema.required || [];
      return Object.entries(schema.properties).map(function(entry) {
        var name = entry[0], prop = entry[1];
        return {
          name: name,
          type: prop.type || 'string',
          description: prop.description || '',
          required: required.includes(name),
        };
      });
    }

    function toggleTool(el) {
      const panel = el.querySelector('.tool-panel');
      const wasOpen = panel.classList.contains('open');
      document.querySelectorAll('.tool-panel.open').forEach(function(p) {
        p.classList.remove('open');
        p.closest('.tool-item').classList.remove('active');
      });
      if (!wasOpen) {
        panel.classList.add('open');
        el.classList.add('active');
      }
    }

    async function runTool(name, btn) {
      var safeId = escAttr(name);
      const panel = document.getElementById('panel-' + safeId);
      const resultBox = document.getElementById('result-' + safeId);
      if (!panel || !resultBox) return;

      const inputs = panel.querySelectorAll('.param-input');
      const args = {};
      inputs.forEach(function(input) {
        const val = input.value.trim();
        if (val) {
          try { args[input.dataset.param] = JSON.parse(val); }
          catch(e) { args[input.dataset.param] = val; }
        }
      });

      btn.disabled = true;
      btn.textContent = 'Running...';
      resultBox.className = 'result-box visible';
      resultBox.textContent = 'Executing ' + name + '...';

      try {
        const res = await fetch('/api/hostinger/call', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ tool: name, args: args }),
        });
        const data = await res.json();
        if (data.error) {
          resultBox.className = 'result-box visible error';
          resultBox.textContent = 'Error: ' + data.error + (data.hint ? ' â€” ' + data.hint : '');
        } else {
          resultBox.className = 'result-box visible';
          let content = data.result?.content;
          if (Array.isArray(content)) {
            content = content.map(function(c) {
              if (c.type === 'text') {
                try { return JSON.stringify(JSON.parse(c.text), null, 2); }
                catch(e) { return c.text; }
              }
              return JSON.stringify(c, null, 2);
            }).join('\n');
          } else {
            content = JSON.stringify(data.result, null, 2);
          }
          resultBox.textContent = content;
        }
      } catch (err) {
        resultBox.className = 'result-box visible error';
        resultBox.textContent = 'Request failed: ' + err.message;
      }

      btn.disabled = false;
      btn.textContent = 'Execute';
    }

    toolSearch.addEventListener('input', function() {
      const q = toolSearch.value.toLowerCase();
      document.querySelectorAll('.tool-item').forEach(function(item) {
        const name = (item.getAttribute('data-name') || '').toLowerCase();
        const desc = (item.querySelector('.tool-desc')?.textContent || '').toLowerCase();
        item.classList.toggle('hidden', q && !name.includes(q) && !desc.includes(q));
      });
      document.querySelectorAll('.tool-group').forEach(function(group) {
        const visible = group.querySelectorAll('.tool-item:not(.hidden)').length;
        group.classList.toggle('hidden', visible === 0);
      });
    });
  </script>
  <script src="/nav-toggle.js"></script>
</body>
</html>
